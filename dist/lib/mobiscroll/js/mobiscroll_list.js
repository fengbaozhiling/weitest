!function(e){var n=e.mobiscroll,i={invalid:[],showInput:!0,inputClass:""},l=function(n){function l(n,i,l,t){for(var o=0;i>o;){var a=e(".dwwl"+o,n),u=r(t,o,l);e.each(u,function(n,i){e('.dw-li[data-val="'+i+'"]',a).removeClass("dw-v")}),o++}}function r(e,n,i){for(var l,r=0,t=i,o=[];n>r;){var a=e[r];for(l in t)if(t[l].key==a){t=t[l].children;break}r++}for(r=0;r<t.length;)t[r].invalid&&o.push(t[r].key),r++;return o}function t(e,n){for(var i=[];e;)i[--e]=!0;return i[n]=!1,i}function o(e){var n,i=[];for(n=0;e>n;n++)i[n]=y.labels&&y.labels[n]?y.labels[n]:n;return i}function a(e,n,i){var l,r,t,o=0,a=[],c=S;if(n)for(l=0;n>l;l++)a[l]=[{}];for(;o<e.length;){for(a[o]=[d(c,C[o])],l=0,t=void 0;l<c.length&&void 0===t;)c[l].key==e[o]&&(void 0!==i&&i>=o||void 0===i)&&(t=l),l++;if(void 0!==t&&c[t].children)o++,c=c[t].children;else{if(!(r=u(c))||!r.children)return a;o++,c=r.children}}return a}function u(e,n){if(!e)return!1;for(var i,l=0;l<e.length;)if(!(i=e[l++]).invalid)return n?l-1:i;return!1}function d(e,n){for(var i={keys:[],values:[],label:n},l=0;l<e.length;)i.values.push(e[l].value),i.keys.push(e[l].key),l++;return i}function c(n,i){e(".dwc",n).css("display","").slice(i).hide()}function v(e){for(var n,i=[],l=e,r=!0,t=0;r;)n=u(l),i[t++]=n.key,r=n.children,r&&(l=r);return i}function s(e,n){var i,l,r,t=[],o=S,a=0,d=!1;if(void 0!==e[a]&&n>=a)for(i=0,l=e[a],r=void 0;i<o.length&&void 0===r;)o[i].key!=e[a]||o[i].invalid||(r=i),i++;else r=u(o,!0),l=o[r].key;for(d=void 0!==r?o[r].children:!1,t[a]=l;d;){if(o=o[r].children,a++,d=!1,r=void 0,void 0!==e[a]&&n>=a)for(i=0,l=e[a],r=void 0;i<o.length&&void 0===r;)o[i].key!=e[a]||o[i].invalid||(r=i),i++;else r=u(o,!0),r=r===!1?void 0:r,l=o[r].key;d=void 0!==r&&u(o[r].children)?o[r].children:!1,t[a]=l}return{lvl:a+1,nVector:t}}function h(n){var i=[];return k=k>b++?k:b,n.children("li").each(function(n){var l=e(this),r=l.clone();r.children("ul,ol").remove();var t=r.html().replace(/^\s\s*/,"").replace(/\s\s*$/,""),o=l.data("invalid")?!0:!1,a={key:l.data("val")||n,value:t,invalid:o,children:null},u=l.children("ul,ol");u.length&&(a.children=h(u)),i.push(a)}),b--,i}var f,p,w=e.extend({},n.settings),y=e.extend(n.settings,i,w),g=e(this),m=this.id+"_dummy",k=0,b=0,x={},S=y.wheelArray||h(g),C=o(k),T=[],V=v(S),A=a(V,k);return e("#"+m).remove(),y.showInput&&(f=e('<input type="text" id="'+m+'" value="" class="'+y.inputClass+'" readonly />').insertBefore(g),y.anchor=f,n.attachShow(f)),y.wheelArray||g.hide().closest(".ui-field-contain").trigger("create"),{width:50,wheels:A,headerText:!1,parseValue:function(e,n){return y.defaultValue||V},onBeforeShow:function(e){var i=n.temp;T=i.slice(0),y.wheels=a(i,k,k),p=!0},onSelect:function(e,n){f&&f.val(e),g.change()},onChange:function(e,n){n.live&&(f&&f.val(e),g.change())},onShow:function(n){e(".dwwl",n).on("mousedown touchstart",function(){clearTimeout(x[e(".dwwl",n).index(this)])})},onDestroy:function(){f&&f.remove(),g.show()},validate:function(e,i,r,o){var u,d=[],v=n.temp,h=(i||0)+1;if(void 0!==i&&T[i]!=v[i]||void 0===i&&!p){for(y.wheels=a(v,null,i),u=s(v,i),void 0!==i&&(n.temp=u.nVector.slice(0));h<u.lvl;)d.push(h++);if(d.length)return y.readonly=t(k,i),clearTimeout(x[i]),x[i]=setTimeout(function(){p=!0,c(e,u.lvl),T=n.temp.slice(0),n.changeWheel(d,void 0===i?r:0,o),y.readonly=!1},void 0===i?0:1e3*r),!1;l(e,u.lvl,S,n.temp)}else u=s(v,v.length),l(e,u.lvl,S,v),c(e,u.lvl);p=!1}}};e.each(["list","image","treelist"],function(e,i){n.presets[i]=l,n.presetShort(i)})}(jQuery);